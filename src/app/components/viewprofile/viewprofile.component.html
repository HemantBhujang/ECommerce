<div class="container-fluid" *ngIf="user">
  <div *ngIf="showPopup" class="popup-overlay">
    <div class="popup-content">
      <p>{{ popupMessage }}</p>
      <button (click)="closePopup()">OK</button>
    </div>
  </div>
  <div class="row profile-container">
    <!-- Sidebar -->
    <div class="col-md-3 sidebar">
      <div class="text-center">
        <img
          src="../../../assets/account_circle_24dp_000000.svg"
          alt="avatar"
          class="rounded-circle"
          width="80"
        />
        <h6 class="mt-2">Hello,{{ user.name }}</h6>
      </div>
      <h5
        class="d-flex justify-content-between align-items-center"
        (click)="goToProfile()"
        style="cursor: pointer"
      >
        <span><i class="bi bi-person active"></i> PROFILE INFORMATION</span>
        <i class="bi bi-chevron-right"></i>
      </h5>
      <h5
        class="d-flex justify-content-between align-items-center"
        (click)="goToOrders()"
        style="cursor: pointer"
      >
        <span><i class="bi bi-bag"></i> MY ORDERS</span>
        <i class="bi bi-chevron-right"></i>
      </h5>

      <h5
        class="d-flex justify-content-between align-items-center"
        (click)="goToCart()"
        style="cursor: pointer"
      >
        <span><i class="bi bi-cart"></i> MY CART</span>
        <i class="bi bi-chevron-right"></i>
      </h5>
      <!-- <a href="#" class="active">Profile Information</a>
      <a href="#">Manage Addresses</a>
      <a href="#">PAN Card Information</a> -->
    </div>

    <!-- Main Content -->
    <!-- Main Content -->
    <div class="col-md-9">
      <span class="edit-link" (click)="toggleEdit('personal')">
        {{ isEditingPersonal ? "Cancel" : "Edit" }}
      </span>
      <div class="profile-box">
        <form [formGroup]="profileForm">
          <!-- Name -->
          <div class="section-name">Name</div>
          <div class="row mb-3">
            <div class="col-md-9">
              <input
                type="text"
                class="form-control"
                formControlName="name"
                [readonly]="!isEditingPersonal"
                [ngClass]="{ 'is-invalid': hasError('name', 'required') }"
              />
              <div
                class="invalid-feedback"
                *ngIf="hasError('name', 'required')"
              >
                Name is required
              </div>
            </div>
          </div>

          <!-- Email -->
          <div class="section-name">Email Address</div>
          <div class="row mb-3">
            <div class="col-md-9">
              <input
                type="email"
                class="form-control"
                formControlName="email"
                [readonly]="!isEditingPersonal"
                [ngClass]="{
                  'is-invalid':
                    hasError('email', 'required') ||
                    hasError('email', 'pattern')
                }"
              />
              <div
                class="invalid-feedback"
                *ngIf="hasError('email', 'required')"
              >
                Email is required
              </div>
              <div
                class="invalid-feedback"
                *ngIf="hasError('email', 'pattern')"
              >
                Please enter a valid email address
              </div>
            </div>
          </div>

          <!-- Address -->
          <div class="section-name">Address</div>
          <div class="row mb-3">
            <div class="col-md-9">
              <input
                type="text"
                class="form-control"
                formControlName="address"
                [readonly]="!isEditingPersonal"
                [ngClass]="{ 'is-invalid': hasError('address', 'required') }"
              />
              <div
                class="invalid-feedback"
                *ngIf="hasError('address', 'required')"
              >
                Address is required
              </div>
            </div>
          </div>

          <!-- Phone -->
          <div class="section-name">Phone</div>
          <div class="row mb-3">
            <div class="col-md-9">
              <input
                type="text"
                class="form-control"
                formControlName="phone_number"
                [readonly]="!isEditingPersonal"
                [ngClass]="{
                  'is-invalid':
                    hasError('phone_number', 'required') ||
                    hasError('phone_number', 'pattern')
                }"
              />
              <div
                class="invalid-feedback"
                *ngIf="hasError('phone_number', 'required')"
              >
                Phone number is required
              </div>
              <div
                class="invalid-feedback"
                *ngIf="hasError('phone_number', 'pattern')"
              >
                Phone number must be exactly 10 digits
              </div>
            </div>
          </div>

          <!-- Nationality -->
          <div class="section-name">Nationality</div>
          <div class="row mb-3">
            <div class="col-md-9">
              <input
                type="text"
                class="form-control"
                formControlName="nationality"
                [readonly]="!isEditingPersonal"
                [ngClass]="{
                  'is-invalid': hasError('nationality', 'required')
                }"
              />
              <div
                class="invalid-feedback"
                *ngIf="hasError('nationality', 'required')"
              >
                Nationality is required
              </div>
            </div>
          </div>
        </form>

        <!-- Save Button -->
        <div class="mt-3" *ngIf="isEditingPersonal">
          <button class="save-btn" (click)="saveProfile()">Save</button>
        </div>
      </div>
    </div>

    <!-- Popup Message -->
    <div class="popup-overlay" *ngIf="showPopup">
      <div class="popup-content">
        <div class="popup-message">{{ popupMessage }}</div>
        <button class="close-btn" (click)="closePopup()">Close</button>
      </div>
    </div>
  </div>
</div>
<app-footer></app-footer>
